# Commonly API Framework

| Class / Function                   | Method               | Access (Public/Private) | Used By System | Params & Output                                                                                                                                                                                                                                                                                                                                    | Description                                                                                                                                                                |
| ---------------------------------- | -------------------- | ----------------------- | -------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `FWBoot`                           | `run`                | Public Static           | Yes            | **Params:** None <br> **Output:** `Promise<void>`                                                                                                                                                                                                                                                                                                  | Initializes lifecycle hook `boot`, database, dependency container, Express app, and HTTP server. Used to boot the entire system.                                           |
| `FWCommon`                         | `env`                | Public Static           | No             | **Params:** `key: string`, `defaultValue: any = null`<br>**Output:** `T`                                                                                                                                                                                                                                                                           | Retrieves environment variable by key with optional default value.                                                                                                         |
|                                    | `baseUrl`            | Public Static           | No             | **Params:** `segment: string = ''`<br>**Output:** `string`                                                                                                                                                                                                                                                                                         | Constructs the base application URL with optional path segment.                                                                                                            |
|                                    | `extractUrl`         | Public Static           | No             | **Params:** `fullUrl: string`, `get: Exclude<keyof URL, 'toJSON'>`<br>**Output:** `any \| URL`                                                                                                                                                                                                                                                     | Parses a full URL and extracts a specific URL component.                                                                                                                   |
|                                    | `json`               | Public Static           | No             | **Params:** `status?: boolean`, `code?: number`, `message?: string`, `result?: object \| any[] \| null`, `custom?: Partial<Record<string, any>>`<br>**Output:** `object`                                                                                                                                                                           | Returns a standardized JSON response format.                                                                                                                               |
|                                    | `handler`            | Public Static           | No             | **Params:** `callback: () => Promise<T>`, `shouldThrow?: (err: any) => T \| Promise<T> \| void`<br>**Output:** `Promise<T>`                                                                                                                                                                                                                        | Executes a callback with error handling. Optionally handles thrown errors.                                                                                                 |
|                                    | `md5`                | Public Static           | No             | **Params:** `input: string`<br>**Output:** `string`                                                                                                                                                                                                                                                                                                | Returns the MD5 hash of a given string.                                                                                                                                    |
|                                    | `randomAlphaNumeric` | Public Static           | No             | **Params:** `length: number`<br>**Output:** `string`                                                                                                                                                                                                                                                                                               | Generates a random alphanumeric string of specified length.                                                                                                                |
| `FWCookie`                         | `init`               | Public Static           | Yes            | **Params:** `req: Request`, `res: Response`<br>**Output:** `void`                                                                                                                                                                                                                                                                                  | Initializes the cookie handler with the provided request and response.                                                                                                     |
|                                    | `all`                | Public Static           | No             | **Params:** None<br>**Output:** `T | null`                                                                                                                                                                                                                                                                                                         | Retrieves all cookie data as an object.                                                                                                                                    |
|                                    | `get`                | Public Static           | No             | **Params:** `keys: string | string[]`<br>**Output:** `T | undefined`                                                                                                                                                                                                                                                                               | Retrieves specific cookie data by key(s).                                                                                                                                  |
|                                    | `set`                | Public Static           | No             | **Params:** `key: string | Record<string, any>`, `value?: any`, `options?: Partial<CookieOptions>`<br>**Output:** `boolean`                                                                                                                                                                                                                        | Sets a cookie value or updates an existing cookie.                                                                                                                         |
|                                    | `remove`             | Public Static           | No             | **Params:** `keys: string | string[]`, `options?: Partial<CookieOptions>`<br>**Output:** `boolean`                                                                                                                                                                                                                                                 | Removes one or more cookies from the response.                                                                                                                             |
|                                    | `clear`              | Public Static           | No             | **Params:** None<br>**Output:** `boolean`                                                                                                                                                                                                                                                                                                          | Clears the cookie from the response.                                                                                                                                       |
|                                    | `#readCookie`        | Private Static          | -              | **Params:** None<br>**Output:** `Record<string, any> | null`                                                                                                                                                                                                                                                                                       | Reads and decrypts the cookie from the request.                                                                                                                            |
|                                    | `#writeCookie`       | Private Static          | -              | **Params:** `data: object`, `options?: Partial<CookieOptions>`<br>**Output:** `boolean`                                                                                                                                                                                                                                                            | Encrypts and writes cookie data to the response.                                                                                                                           |
|                                    | `#encrypt`           | Private Static          | -              | **Params:** `text: string`<br>**Output:** `string`                                                                                                                                                                                                                                                                                                 | Encrypts the given text using AES-256-CBC encryption.                                                                                                                      |
|                                    | `#decrypt`           | Private Static          | -              | **Params:** `encrypted: string`<br>**Output:** `string`                                                                                                                                                                                                                                                                                            | Decrypts the given encrypted text using AES-256-CBC decryption.                                                                                                            |
| `FWExpress`                        | `init`               | Public Static           | Yes            | **Params:** None<br>**Output:** `Promise<void>`                                                                                                                                                                                                                                                                                                    | Initializes the Express application by setting up hooks, middlewares, and routes.                                                                                          |
|                                    | `middlewares`        | Private Static          | Yes            | **Params:** None<br>**Output:** `Promise<void>`                                                                                                                                                                                                                                                                                                    | Configures middlewares like JSON parsing, cookie handling, CORS, static files, and multer for file uploads.                                                                |
|                                    | `routes`             | Private Static          | Yes            | **Params:** None<br>**Output:** `Promise<void>`                                                                                                                                                                                                                                                                                                    | Loads and applies route configurations.                                                                                                                                    |
|                                    | `json`               | Public Static           | No             | **Params:** `res: Response`, `arg1: boolean | { status: boolean, code: number, message: string, result: object | null, custom?: object }`, `arg2?: number`, `arg3?: string`, `arg4?: object | any[] | null`, `arg5?: Partial<Record<string, any>>`<br>**Output:** `Response`                                                                       | Sends a JSON response with status, code, message, and result.                                                                                                              |
|                                    | `view`               | Public Static           | No             | **Params:** `res: Response`, `viewName: string`, `locals: object = {}`, `status: number = 200`<br>**Output:** `Response`                                                                                                                                                                                                                           | Renders a view with the provided locals and status.                                                                                                                        |
|                                    | `redirect`           | Public Static           | No             | **Params:** `res: Response`, `url: string`, `statusCode: number = 302`<br>**Output:** `Response`                                                                                                                                                                                                                                                   | Redirects to the specified URL with the given status code.                                                                                                                 |
| `FWHooks`                          | `register`           | Public Static           | -              | **Params:** `subsystem: Subsystem`, `type: HookType`, `fn: HookFn` <br> **Output:** `void`                                                                                                                                                                                                                                                         | Registers a hook function to be executed for a specific subsystem and hook type.                                                                                           |
|                                    | `init`               | Public Static           | Yes            | **Params:** `subsystem: Subsystem`, `type: HookType` <br> **Output:** `Promise<void>`                                                                                                                                                                                                                                                              | Executes the registered hook functions for a given subsystem and hook type, handling any errors during execution.                                                          |
|                                    | `shutdown`           | Public Static           | Yes            | **Params:** None <br> **Output:** `Promise<void>`                                                                                                                                                                                                                                                                                                  | Runs the shutdown hooks for all subsystems, ensuring proper cleanup during shutdown.                                                                                       |
| `FWJWT`                            | `sign`               | Public Static           | No             | **Params:** `payload: T`, `options: SignOptions = {}` <br> **Output:** `string`                                                                                                                                                                                                                                                                    | Signs a payload with a secret key and returns a JWT token with the specified expiration time.                                                                              |
|                                    | `verify`             | Public Static           | No             | **Params:** `token: string` <br> **Output:** `{ status: boolean; result: T | string }`                                                                                                                                                                                                                                                             | Verifies the JWT token and returns the decoded payload if valid, or an error message if verification fails.                                                                |
|                                    | `encode`             | Public Static           | No             | **Params:** `payload: T` <br> **Output:** `string`                                                                                                                                                                                                                                                                                                 | Encodes a payload into a JWT token without including a timestamp and using the HS256 algorithm.                                                                            |
|                                    | `decode`             | Public Static           | No             | **Params:** `token: string` <br> **Output:** `T | null`                                                                                                                                                                                                                                                                                            | Decodes a JWT token and returns the payload, or `null` if decoding fails.                                                                                                  |
| `FWMailer`                         | `send`               | Public Static           | No             | **Params:** `{ to: string | string[], subject: string, html: string }`<br> **Output:**`Promise<void>`                                                                                                                                                                                                                                              | Sends an email using a configured mail transport service, with the provided recipient, subject, and content.                                                               |
| `FWPaginate`                       | `make`               | Public Static           | No             | **Params:** `repo: Repository<T>, params: PaginateParams<T>` <br> **Output:** `Promise<PaginateResult<T>>`                                                                                                                                                                                                                                         | Paginates query results based on provided parameters, including filters, limit, and page number. Returns paginated data.                                                   |
| (Base Repository) `FWRepository`   | `pagination`         | public static           | -              | **Params:** `params: PaginateParams<T>` <br> **Output:** `Promise<PaginateResult<T>>`                                                                                                                                                                                                                                                              | Handles pagination with optional search and filter, leveraging the `Paginate` utility.                                                                                     |
|                                    | `all`                | public static           | No             | **Params:** `relations: string[] = []` <br> **Output:** `Promise<T[]>`                                                                                                                                                                                                                                                                             | Retrieves all records, optionally including related entities based on provided relations.                                                                                  |
|                                    | `by`                 | public static           | No             | **Params:** `index: string` | `number` | `Record<string, any>` | `string[]`, `value?: string` | `number` | `string[]` | `null`, `relations: string[]` = []`<br> **Output:**`Promise<T[]>`                                                                                                                                                                       | Performs flexible searches based on key-value or object, supporting `LIKE` and `IN` filters depending on input types.                                                      |
|                                    | `store`              | public static           | No             | **Params:** `data: DeepPartial<T>` <br> **Output:** `Promise<T>`                                                                                                                                                                                                                                                                                   | Creates and stores a new record based on provided data.                                                                                                                    |
|                                    | `update`             | public static           | No             | **Params:** `data: DeepPartial<T>`, `criteria: number | FindOptionsWhere<T>`<br> **Output:**`Promise<T | null>`                                                                                                                                                                                                                                    | Updates an existing record based on ID or criteria, returning the updated record or `null` if not found.                                                                   |
|                                    | `delete`             | public static           | No             | **Params:** `criteria: number | FindOptionsWhere<T>`<br> **Output:**`Promise<boolean>`                                                                                                                                                                                                                                                             | Deletes a record based on ID or criteria and returns `true` if a record was deleted, `false` otherwise.                                                                    |
|                                    | `findOne`            | public static           | No             | **Params:** `criteria: number | FindOptionsWhere<T>`, `relations: string[] = []`<br> **Output:**`Promise<T | null>`                                                                                                                                                                                                                                | Retrieves one record based on ID or criteria, optionally including related entities.                                                                                       |
|                                    | `exists`             | public static           | No             | **Params:** `criteria: FindOptionsWhere<T>` <br> **Output:** `Promise<boolean>`                                                                                                                                                                                                                                                                    | Checks if a record exists based on the provided criteria and returns `true` or `false`.                                                                                    |
| `Routes`                           | `add`                | public static           | No             | **Params:** <br> `methods` (`RouteMethod | RouteMethod[]`) <br> `path` (`string`) <br> `handler` (`RouteHandler`) <br> `middlewares` (`RouteMiddleware[]`, optional) <br> **Output:** `void`                                                                                                                                                       | Registers a new route with HTTP methods, path, handler, and middlewares.                                                                                                   |
|                                    | `get`                | public static           | No             | **Params:** <br> `path` (`string`) <br> `handler` (`RouteHandler`) <br> `middlewares` (`RouteMiddleware[]`, optional) <br> **Output:** `void`                                                                                                                                                                                                      | Registers a GET route for the specified path and handler.                                                                                                                  |
|                                    | `post`               | public static           | No             | **Params:** <br> `path` (`string`) <br> `handler` (`RouteHandler`) <br> `middlewares` (`RouteMiddleware[]`, optional) <br> **Output:** `void`                                                                                                                                                                                                      | Registers a POST route for the specified path and handler.                                                                                                                 |
|                                    | `put`                | public static           | No             | **Params:** <br> `path` (`string`) <br> `handler` (`RouteHandler`) <br> `middlewares` (`RouteMiddleware[]`, optional) <br> **Output:** `void`                                                                                                                                                                                                      | Registers a PUT route for the specified path and handler.                                                                                                                  |
|                                    | `delete`             | public static           | No             | **Params:** <br> `path` (`string`) <br> `handler` (`RouteHandler`) <br> `middlewares` (`RouteMiddleware[]`, optional) <br> **Output:** `void`                                                                                                                                                                                                      | Registers a DELETE route for the specified path and handler.                                                                                                               |
|                                    | `patch`              | public static           | No             | **Params:** <br> `path` (`string`) <br> `handler` (`RouteHandler`) <br> `middlewares` (`RouteMiddleware[]`, optional) <br> **Output:** `void`                                                                                                                                                                                                      | Registers a PATCH route for the specified path and handler.                                                                                                                |
|                                    | `options`            | public static           | No             | **Params:** <br> `path` (`string`) <br> `handler` (`RouteHandler`) <br> `middlewares` (`RouteMiddleware[]`, optional) <br> **Output:** `void`                                                                                                                                                                                                      | Registers an OPTIONS route for the specified path and handler.                                                                                                             |
|                                    | `head`               | public static           | No             | **Params:** <br> `path` (`string`) <br> `handler` (`RouteHandler`) <br> `middlewares` (`RouteMiddleware[]`, optional) <br> **Output:** `void`                                                                                                                                                                                                      | Registers a HEAD route for the specified path and handler.                                                                                                                 |
|                                    | `group`              | public static           | No             | **Params:** <br> `prefix` (`string`) <br> `callback` (`() => void`) <br> `middlewares` (`RouteMiddleware[]`, optional) <br> **Output:** `void`                                                                                                                                                                                                     | Defines a group of routes with a shared prefix and middlewares.                                                                                                            |
|                                    | `middleware`         | public static           | No             | **Params:** <br> `middlewares` (`RouteMiddleware[]`) <br> `callback` (`() => void`) <br> **Output:** `void`                                                                                                                                                                                                                                        | Registers global middlewares for all routes.                                                                                                                               |
|                                    | `apply`              | public static           | Yes            | **Params:** <br> `router` (`Router`) <br> **Output:** `Promise<void>`                                                                                                                                                                                                                                                                              | Applies the registered routes to the provided Express router.                                                                                                              |
| `FWServer`                         | `init`               | public static           | Yes            | **Params:** None <br> **Output:** `Promise<void>`                                                                                                                                                                                                                                                                                                  | Initializes the server, binds it to a port, and runs lifecycle hooks before and after the server starts. Ensures the server is running and listens on the configured port. |
| `FWSocket`                         | `io`                 | public static           | No             | **Params:** `Server` (from `socket.io`), `SocketConfig.cors` <br> **Output:** `Server` instance of `socket.io`                                                                                                                                                                                                                                     | Initializes a new Socket.IO server instance using the server from `FWServer` and socket configuration from `SocketConfig`.                                                 |
| `Database`                         | `instance`           | public static           | No             | **Params:** None <br> **Output:** `DataSource`                                                                                                                                                                                                                                                                                                     | Retrieves the database instance. Throws an error if the instance is not initialized.                                                                                       |
|                                    | `config`             | public static           | Yes            | **Params:** None <br> **Output:** `DataSourceOptions`                                                                                                                                                                                                                                                                                              | Returns the database configuration based on environment settings.                                                                                                          |
|                                    | `init`               | public static async     | Yes            | **Params:** None <br> **Output:** `Promise<void>`                                                                                                                                                                                                                                                                                                  | Initializes the database connection and runs hooks before and after initialization.                                                                                        |
|                                    | `executeSeed`        | public static async     | No             | **Params:** `{ entity: Entity, data: T[] }` <br> **Output:** `Promise<void>`                                                                                                                                                                                                                                                                       | Executes the seeding process for a specific entity using provided data.                                                                                                    |
| `Validator`                        | `default`            | public async            | No             | **Params:** <br> - `dtoClass`: `ClassConstructor<T>` (class to validate against) <br> - `plain`: `object` (plain object to validate) <br> **Output:** <br> - `Promise<{ valid: true; data: T } | { valid: false; errors: any[] }>`                                                                                                                 | Validates a plain object against a DTO class using `class-validator`. Returns a success or error result.                                                                   |
